"use strict";(self.webpackChunkgf_site=self.webpackChunkgf_site||[]).push([[6406],{270941:(n,e,o)=>{o.r(e),o.d(e,{assets:()=>l,contentTitle:()=>s,default:()=>g,frontMatter:()=>c,metadata:()=>t,toc:()=>p});const t=JSON.parse('{"id":"docs/\u7ec4\u4ef6\u5217\u8868/\u6570\u636e\u7ed3\u6784/\u5bf9\u8c61\u590d\u7528-gpool/\u5bf9\u8c61\u590d\u7528-\u57fa\u672c\u4f7f\u7528","title":"\u5bf9\u8c61\u590d\u7528-\u57fa\u672c\u4f7f\u7528","description":"\u5728GoFrame\u6846\u67b6\u4e2d\u4f7f\u7528gpool\u8fdb\u884c\u5bf9\u8c61\u590d\u7528\u3002\u5728\u793a\u4f8b\u4e2d\uff0c\u6211\u4eec\u521b\u5efa\u548c\u64cd\u4f5c\u4e86\u4e00\u4e2a\u5bf9\u8c61\u6c60\uff0c\u5c55\u793a\u4e86\u5bf9\u8c61\u7684\u83b7\u53d6\u3001\u8fd4\u56de\u53ca\u8fc7\u671f\u5904\u7406\u65b9\u6cd5\u3002\u6b64\u65b9\u6cd5\u5bf9\u4e8e\u7ba1\u7406\u77ed\u751f\u547d\u5468\u671f\u7684\u8d44\u6e90\u975e\u5e38\u6709\u6548\uff0c\u53ef\u4ee5\u663e\u8457\u63d0\u9ad8\u7a0b\u5e8f\u6027\u80fd\u548c\u8d44\u6e90\u5229\u7528\u7387\u3002","source":"@site/versioned_docs/version-2.7.x/docs/\u7ec4\u4ef6\u5217\u8868/\u6570\u636e\u7ed3\u6784/\u5bf9\u8c61\u590d\u7528-gpool/\u5bf9\u8c61\u590d\u7528-\u57fa\u672c\u4f7f\u7528.md","sourceDirName":"docs/\u7ec4\u4ef6\u5217\u8868/\u6570\u636e\u7ed3\u6784/\u5bf9\u8c61\u590d\u7528-gpool","slug":"/docs/components/container-gpool-example","permalink":"/2.7.x/docs/components/container-gpool-example","draft":false,"unlisted":false,"editUrl":"https://github.com/gogf/gf-site/blob/main/versioned_docs/version-2.7.x/docs/\u7ec4\u4ef6\u5217\u8868/\u6570\u636e\u7ed3\u6784/\u5bf9\u8c61\u590d\u7528-gpool/\u5bf9\u8c61\u590d\u7528-\u57fa\u672c\u4f7f\u7528.md","tags":[],"version":"2.7.x","sidebarPosition":0,"frontMatter":{"slug":"/docs/components/container-gpool-example","title":"\u5bf9\u8c61\u590d\u7528-\u57fa\u672c\u4f7f\u7528","sidebar_position":0,"hide_title":true,"keywords":["\u5bf9\u8c61\u590d\u7528","GoFrame","GoFrame\u6846\u67b6","gpool","\u5bf9\u8c61\u6c60","Go\u8bed\u8a00","golang","\u7f51\u7edc\u8fde\u63a5","\u8d44\u6e90\u7ba1\u7406","\u7f16\u7a0b\u6559\u7a0b"],"description":"\u5728GoFrame\u6846\u67b6\u4e2d\u4f7f\u7528gpool\u8fdb\u884c\u5bf9\u8c61\u590d\u7528\u3002\u5728\u793a\u4f8b\u4e2d\uff0c\u6211\u4eec\u521b\u5efa\u548c\u64cd\u4f5c\u4e86\u4e00\u4e2a\u5bf9\u8c61\u6c60\uff0c\u5c55\u793a\u4e86\u5bf9\u8c61\u7684\u83b7\u53d6\u3001\u8fd4\u56de\u53ca\u8fc7\u671f\u5904\u7406\u65b9\u6cd5\u3002\u6b64\u65b9\u6cd5\u5bf9\u4e8e\u7ba1\u7406\u77ed\u751f\u547d\u5468\u671f\u7684\u8d44\u6e90\u975e\u5e38\u6709\u6548\uff0c\u53ef\u4ee5\u663e\u8457\u63d0\u9ad8\u7a0b\u5e8f\u6027\u80fd\u548c\u8d44\u6e90\u5229\u7528\u7387\u3002"},"sidebar":"mainSidebar","previous":{"title":"\u5bf9\u8c61\u590d\u7528-gpool","permalink":"/2.7.x/docs/components/container-gpool"},"next":{"title":"\u5e76\u53d1\u5b89\u5168\u73af-gring","permalink":"/2.7.x/docs/components/container-gring"}}');var i=o(474848),r=o(28453);const c={slug:"/docs/components/container-gpool-example",title:"\u5bf9\u8c61\u590d\u7528-\u57fa\u672c\u4f7f\u7528",sidebar_position:0,hide_title:!0,keywords:["\u5bf9\u8c61\u590d\u7528","GoFrame","GoFrame\u6846\u67b6","gpool","\u5bf9\u8c61\u6c60","Go\u8bed\u8a00","golang","\u7f51\u7edc\u8fde\u63a5","\u8d44\u6e90\u7ba1\u7406","\u7f16\u7a0b\u6559\u7a0b"],description:"\u5728GoFrame\u6846\u67b6\u4e2d\u4f7f\u7528gpool\u8fdb\u884c\u5bf9\u8c61\u590d\u7528\u3002\u5728\u793a\u4f8b\u4e2d\uff0c\u6211\u4eec\u521b\u5efa\u548c\u64cd\u4f5c\u4e86\u4e00\u4e2a\u5bf9\u8c61\u6c60\uff0c\u5c55\u793a\u4e86\u5bf9\u8c61\u7684\u83b7\u53d6\u3001\u8fd4\u56de\u53ca\u8fc7\u671f\u5904\u7406\u65b9\u6cd5\u3002\u6b64\u65b9\u6cd5\u5bf9\u4e8e\u7ba1\u7406\u77ed\u751f\u547d\u5468\u671f\u7684\u8d44\u6e90\u975e\u5e38\u6709\u6548\uff0c\u53ef\u4ee5\u663e\u8457\u63d0\u9ad8\u7a0b\u5e8f\u6027\u80fd\u548c\u8d44\u6e90\u5229\u7528\u7387\u3002"},s=void 0,l={},p=[{value:"\u57fa\u672c\u4f7f\u7528",id:"\u57fa\u672c\u4f7f\u7528",level:2},{value:"\u521b\u5efa\u53ca\u9500\u6bc1\u65b9\u6cd5",id:"\u521b\u5efa\u53ca\u9500\u6bc1\u65b9\u6cd5",level:2}];function a(n){const e={code:"code",h2:"h2",p:"p",pre:"pre",...(0,r.R)(),...n.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(e.h2,{id:"\u57fa\u672c\u4f7f\u7528",children:"\u57fa\u672c\u4f7f\u7528"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-go",children:'package main\n\nimport (\n    "github.com/gogf/gf/v2/container/gpool"\n    "fmt"\n    "time"\n)\n\nfunc main () {\n    // \u521b\u5efa\u4e00\u4e2a\u5bf9\u8c61\u6c60\uff0c\u8fc7\u671f\u65f6\u95f4\u4e3a1\u79d2\n    p := gpool.New(time.Second, nil)\n\n    // \u4ece\u6c60\u4e2d\u53d6\u4e00\u4e2a\u5bf9\u8c61\uff0c\u8fd4\u56denil\u53ca\u9519\u8bef\u4fe1\u606f\n    fmt.Println(p.Get())\n\n    // \u4e22\u4e00\u4e2a\u5bf9\u8c61\u5230\u6c60\u4e2d\n    p.Put(1)\n\n    // \u91cd\u65b0\u4ece\u6c60\u4e2d\u53d6\u4e00\u4e2a\u5bf9\u8c61\uff0c\u8fd4\u56de1\n    fmt.Println(p.Get())\n\n    // \u7b49\u5f852\u79d2\u540e\u91cd\u8bd5\uff0c\u53d1\u73b0\u5bf9\u8c61\u5df2\u8fc7\u671f\uff0c\u8fd4\u56denil\u53ca\u9519\u8bef\u4fe1\u606f\n    time.Sleep(2*time.Second)\n    fmt.Println(p.Get())\n}\n'})}),"\n",(0,i.jsx)(e.h2,{id:"\u521b\u5efa\u53ca\u9500\u6bc1\u65b9\u6cd5",children:"\u521b\u5efa\u53ca\u9500\u6bc1\u65b9\u6cd5"}),"\n",(0,i.jsx)(e.p,{children:"\u6211\u4eec\u53ef\u4ee5\u7ed9\u5b9a\u52a8\u6001\u521b\u5efa\u53ca\u9500\u6bc1\u65b9\u6cd5\u3002"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-go",children:'package main\n\nimport (\n    "fmt"\n    "github.com/gogf/gf/v2/container/gpool"\n    "github.com/gogf/gf/v2/net/gtcp"\n    "github.com/gogf/gf/v2/os/glog"\n    "time"\n)\n\nfunc main() {\n    // \u521b\u5efa\u5bf9\u8c61\u590d\u7528\u6c60\uff0c\u5bf9\u8c61\u8fc7\u671f\u65f6\u95f4\u4e3a3\u79d2\uff0c\u5e76\u7ed9\u5b9a\u521b\u5efa\u53ca\u9500\u6bc1\u65b9\u6cd5\n    p := gpool.New(3*time.Second, func() (interface{}, error) {\n        return gtcp.NewConn("www.baidu.com:80")\n    }, func(i interface{}) {\n        glog.Println("expired")\n        i.(*gtcp.Conn).Close()\n    })\n    conn, err := p.Get()\n    if err != nil {\n        panic(err)\n    }\n    result, err := conn.(*gtcp.Conn).SendRecv([]byte("HEAD / HTTP/1.1\\n\\n"), -1)\n    if err != nil {\n        panic(err)\n    }\n    fmt.Println(string(result))\n    // \u4e22\u56de\u6c60\u4e2d\u4ee5\u4fbf\u91cd\u590d\u4f7f\u7528\n    p.Put(conn)\n    // \u7b49\u5f85\u4e00\u5b9a\u65f6\u95f4\u89c2\u5bdf\u8fc7\u671f\u65b9\u6cd5\u8c03\u7528\n    time.Sleep(4*time.Second)\n}\n'})}),"\n",(0,i.jsx)(e.p,{children:"\u6267\u884c\u540e\uff0c\u7ec8\u7aef\u8f93\u51fa\u7ed3\u679c\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:'HTTP/1.1 302 Found\nConnection: Keep-Alive\nContent-Length: 17931\nContent-Type: text/html\nDate: Wed, 29 May 2019 11:23:20 GMT\nEtag: "54d9749e-460b"\nServer: bfe/1.0.8.18\n\n2019-05-29 19:23:24.732 expired\n'})})]})}function g(n={}){const{wrapper:e}={...(0,r.R)(),...n.components};return e?(0,i.jsx)(e,{...n,children:(0,i.jsx)(a,{...n})}):a(n)}},28453:(n,e,o)=>{o.d(e,{R:()=>c,x:()=>s});var t=o(296540);const i={},r=t.createContext(i);function c(n){const e=t.useContext(r);return t.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function s(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(i):n.components||i:c(n.components),t.createElement(r.Provider,{value:e},n.children)}}}]);